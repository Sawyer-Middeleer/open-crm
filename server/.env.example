# Open CRM Server Configuration
# Copy this file to .env and fill in your values

# =============================================================================
# REQUIRED
# =============================================================================

# Convex deployment URL (from 'bunx convex dev')
CONVEX_URL=https://your-deployment.convex.cloud

# =============================================================================
# SERVER
# =============================================================================

# HTTP server configuration
PORT=3000
HOSTNAME=0.0.0.0

# CORS allowed origins (comma-separated)
# CORS_ALLOWED_ORIGINS=https://app.example.com,https://admin.example.com

# MCP resource URI (for OAuth metadata, defaults to request origin)
# MCP_RESOURCE_URI=https://api.open-crm.example/mcp

# =============================================================================
# SESSION & RATE LIMITING
# =============================================================================

# Session timeout in minutes (default: 30)
# SESSION_TTL_MINUTES=30

# Session cleanup interval in minutes (default: 5)
# SESSION_CLEANUP_MINUTES=5

# Rate limits (requests per minute)
# IP_RATE_LIMIT_PER_MINUTE=100
# USER_RATE_LIMIT_PER_MINUTE=300

# =============================================================================
# OAUTH - TOKEN VALIDATION (Resource Server)
# =============================================================================

# OAuth provider: "auth0" or "custom"
MCP_AUTH_PROVIDER=auth0

# Auth0 configuration
AUTH0_DOMAIN=your-tenant.auth0.com
AUTH0_AUDIENCE=https://api.open-crm.example

# Custom OIDC provider (alternative to Auth0)
# MCP_AUTH_PROVIDER=custom
# OAUTH_ISSUER=https://your-idp.com
# OAUTH_JWKS_URI=https://your-idp.com/.well-known/jwks.json
# OAUTH_AUDIENCE=https://api.open-crm.example

# =============================================================================
# OAUTH - AUTHORIZATION SERVER PROXY (for MCP client authentication)
# =============================================================================

# When these are set, Open CRM acts as an OAuth Authorization Server
# that proxies to Auth0. This enables MCP clients to authenticate
# without needing to configure Auth0 directly.

# Auth0 Regular Web Application credentials
# (Create a "Regular Web Application" in Auth0, NOT Machine-to-Machine)
AUTH0_WEB_CLIENT_ID=your-web-app-client-id
AUTH0_WEB_CLIENT_SECRET=your-client-secret

# Callback URL (must be registered in Auth0's Allowed Callback URLs)
OAUTH_CALLBACK_URL=https://your-server.com/oauth/callback

# Dynamic Client Registration (default: enabled)
# Set to "false" to disable DCR
# DCR_ENABLED=false

# =============================================================================
# API KEY AUTHENTICATION
# =============================================================================

# API key auth is enabled by default
# Set to "false" to disable API key authentication
# API_KEY_AUTH_ENABLED=false

# =============================================================================
# WORKSPACE
# =============================================================================

# Auto-create workspace for new OAuth users (default: enabled)
# Set to "true" to require manual workspace creation
# DISABLE_AUTO_WORKSPACE=true

# =============================================================================
# LOCAL DEVELOPMENT (stdio transport)
# =============================================================================

# For local MCP development via stdio transport
# These are set by 'bun run setup' wizard
# DEV_USER_EMAIL=you@example.com
# DEV_WORKSPACE_ID=your-workspace-id
